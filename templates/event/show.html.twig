{% extends 'base.html.twig' %}

{% block title %}
    {{ event.title }} - Event Details
{% endblock %}

{% block body %}

    <div class="event-detail-wrapper">

        <div class="event-detail-top">
            <div>
                <h2>{{ event.title|upper }}</h2>
                <h3>{{ event.datetimeStart|date("d/m/Y H:i") }}</h3>
            </div>
            <h3>Created by {{ event.creator.username }}</h3>
        </div>

        <div class="event-detail-main">
            <p class="event-detail-description">
                {{ event.description}}
            </p>

            <figure class="event-img">
                {% if event.image %}
                    <img src="{{ asset('img/event/' ~ event.image) }}" alt="">
                {% else %}
                    <img src="{{ asset('img/partials/image_not_found.png') }}" alt="">
                {% endif %}
            </figure>
        </div>

        <div class="event-detail-bottom">

            <h3><i class="fa-solid fa-user"></i> {{ event.users | length }} users</h3>

            <div class="btns">
                {% if isJoined %}
                    <a class="btn event-detail-btn event-leave-btn" href="{{ path('event_leave', {id: event.id, title: event.title}) }}">
                        Joined <i class="fa-solid fa-check"></i>
                    </a>
                {% else %}
                    {% if event.isPrivate %}
                        <a class="btn event-detail-btn" href={{ path('event_request', {id: event.id, title: event.title}) }}>Send a request</a>
                    {% elseif user.hasEventRequest(event) %}
                        <a class="btn event-detail-btn" href="{{ path('event_cancel_request', {id: event.id, title: event.title}) }}">Cancel request</a>
                    {% else %}
                        <a class="btn event-detail-btn" href={{ path('event_join', {id: event.id, title: event.title}) }}>Join</a>
                    {% endif %}
                {% endif %}
                <a class="btn btn-secondary-detail event-detail-btn" href="">Share <i class="fa-solid fa-share-nodes"></i></a>
                {% if app.user == event.creator %}
                    <a class="btn btn-secondary-detail event-detail-btn" href="{{ path('event_edit', {id: event.id}) }}">Edit <i class="fa-solid fa-pen-to-square"></i></a>
                    <form method="post" action="{{ path('event_delete', {id: event.id}) }}" onsubmit="return confirm('Are you sure you want to delete this event?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ event.id) }}">
                        <button type="submit" class="btn btn-secondary-detail event-detail-btn">Delete</button>
                    </form>
                {% endif %}
            </div>
        </div>

    </div>

{% endblock %}

