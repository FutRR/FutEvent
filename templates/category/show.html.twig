{% extends 'base.html.twig' %}

{% block body %}

    <h1>{{ category.name }}</h1>

    <div class="btns">
        {% if app.user %}
            <a class="btn" href={{ path('event_new', {categoryId: category.id}) }}>Create {{ category.name }} Event</a>
        {% endif %}
        {% if is_granted('ROLE_ADMIN') %}
            <a class="btn" href="{{ path('category_edit', {id: category.id}) }}">Edit</a>
            <form method="post" action="{{ path('category_delete', {id: category.id}) }}" onsubmit="return confirm('Are you sure you want to delete this category?');">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ category.id) }}">
                <button type="submit" class="btn">Delete</button>
            </form>
        {% endif %}
    </div>


    <div class="search-wrapper">
        <form class="search-form" action="" method="post">
            <label>
                <input type="text" name="query" placeholder="Search...">
            </label>
            <button class="search-btn" type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
        </form>
    </div>

    <div class="events-list">
        {% for event in events %}
            {% include 'components/_event_card.html.twig' with { event: event } %}
        {% else %}
            <p>No events found in this category.</p>
        {% endfor %}

    </div>

{% endblock %}

{% block title %}
    {{ category.name }}
{% endblock %}

